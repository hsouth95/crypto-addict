<html>
    <head>
        <meta name="color-scheme" content="dark light" />
        <style>
            body {
                color: #eee;
                background-color: #121212;
                padding: 50px;
            }
            #crypto-list {
            }
            #crypto-list > li {
                list-style: none;
                background-color: #404040;
                border-radius: 2px;
                padding: 20px;
                margin-bottom: 10px;
            }

            .decrease {
                color: #e08283 !important;
            }
            .increase {
                color: #2abb9b !important;
            }
        </style>
    </head>
    <body>
        <ul id="crypto-list"></ul>
    </body>
    <script>
        const LOCAL_KEY = "crypto-prices";
        const CURRENCY = "usd";
        const COINS = ["bitcoin", "ethereum", "dogecoin", "binancecoin", "cardano"];
        const ROOT_URL = "https://api.coingecko.com/api/v3/";
        const PRICE_ENDPOINT = "simple/price";

        const PRICE_DATA = `?ids=${COINS.join(",")}&vs_currencies=${CURRENCY}`;

        fetch(ROOT_URL + PRICE_ENDPOINT + PRICE_DATA)
            .then((response) => response.json())
            .then((data) => {
                console.log(data);
                if (localStorage.getItem(LOCAL_KEY)) {
                    const previousValues = JSON.parse(localStorage.getItem(LOCAL_KEY));
                    for (let [crypto, price] of Object.entries(previousValues)) {
                        let increase = data[crypto].usd - price.usd;
                        let difference = (increase / price.usd) * 100;
                        console.log(`Difference between values for ${crypto} is ${difference.toFixed(2)}`);
                        addCryptoDifference(crypto, data[crypto].usd, difference.toFixed(2));
                    }
                }
                localStorage.setItem(LOCAL_KEY, JSON.stringify(data));
            });

        function addCryptoDifference(crypto, price, difference) {
            let element = document.createElement("li");
            element.innerText = `${crypto} - ${price} - ${difference}`;

            let nameElement = document.createElement("span");
            let priceElement = document.createElement("span");
            let diffElement = document.createElement("span");

            if (difference > 0) {
                element.classList.add("increase");
            } else if (difference < 0) {
                element.classList.add("decrease");
            }

            document.getElementById("crypto-list").append(element);
        }
    </script>
</html>
